Structure from Motion with Line Segments Under Relaxed Endpoint Constraints
==============================================================================

本文提出了一种新颖的 SfM 管道，它可以从多个视图中的成像线段估计运动和 3D 结构。

利用线进行SfM的方法很少见。 缺乏实用算法的原因源于从线段对应估计相机运动时面临的困难：

1. 线段端点的位置很难预测，线段的各个部分可能会被遮挡，以至于它们经常分成几个部分，使得匹配成为一项非常困难的任务。

2. 端点的不稳定性使得对极几何的直接计算不切实际。（Zhang 进行了尝试，结果表明需要超过50组对应关系才能得到稳定解）

   利用无限线进行运动估计解决了这个问题，但与点相比，线不受对极几何的约束，因此至少需要三个视图和13组对应关系。

3. 在直线的方向上平移运动是不确定的。 当数据由具有相同方向的 3D 线主导时，由此产生的规范自由度（gauge freedom）导致平移运动估计产生强烈漂移

.. figure:: 1.jpg
   :figclass: align-center

本文提出的方法不需要平面线配置，可以实现两视图运动估计，但利用了三焦点图像关系。

.. note::

   在这里，通过旋转和平移的解耦估计（decoupled estimation）来提高效率。

   具体而言，给定旋转，校准相机的平移可以从三个视图中的五条线的对应关系以线性方式进行估计，从而能够应用稳健的随机采样算法，如 RANSAC。

同时，本文提出新的BA误差度量，将端点考虑在内以有效对解决姿漂移问题。

步骤
--------

根据序列的前三个视图中检测到的线段计算初始3D模型和相对位姿，每个新输入图像相对于现有 3D 点云的同时绝对定位和随后的点云更新。

在相对和绝对位姿估计之前，检测线段，与描述符相关联，并与之前的视图或现有的 3D 点云匹配。

在位姿估计之后，考虑三个校准视图，执行引导的、无描述符的匹配，然后对线段进行三角化以生成 3D 点云。

3D 模型与现有点云合并，并与改进的位姿一起BA。

.. important::

   :符号:

      1. 假设标定的相机 :math:`p_{j,i} = N([R_j~t_j]_{3\times 4}(X_i^T~ 1)^T)` ，其中 :math:`p_{j,i}` 是第 :math:`i` 个3D点 :math:`X_i` 在第 :math:`j` 个相机中的单位长度向量，由归一化函数 :math:`N(v) = v / norm(v)` 得到。

      2. 假设每个图像像素都可以通过已知映射转换为投影光线 :math:`p_{j,i}` ，反之亦然。

      3. 使用所有位于单位球面上的单位向量，这样就可以处理透视和全方位图像。

      4. 为了保持传感设备的通用性，所有的误差函数都是在 3D 中而不是在图像空间中定义的。

      5. 所有的线由其解析面的单位法线 :math:`n_{j,i}` 表示

         .. figure:: 2.jpg
            :figclass: align-center

         定义为：

         .. math::

            n_{j,i} = N(\hat{p}_{j,i} \times \hat{p}'_{j,i})

         其中 :math:`\hat{p}_{j,i}, \hat{p}'_{j,i}` 是成像线段的两个端点的射线。

检测和匹配线段
---------------

视图之间的线段匹配遵循一个简单的策略。

使用固定大小的 SIFT 提取的关键点作为端点，方向由线段的方向给出，从它的中点看。 （没看懂，原文是We utilize ﬁxed sized SIFT keys placed at the end-points, with orientation given by the direction of the segment, as seen from its midpoint.）

为了建立临时匹配，将每个端点描述符与另一个线段上最近的端点进行比较。 如果总描述符距离得分比下一个最佳候选者好 20%，则建立成功匹配。

初始化3D点云
-------------

关键步骤是生成初始 3D 线结构，构成增量添加后续帧的基础。将旋转和平移的估计解耦。该求解器只需要三个视图中的五个对应关系。

具体来说，首先使用线段对应关系计算所有图像对的相对旋转。随后，从三个视图的匹配中，我们同时估计平移并通过简单的 RANSAC 程序构建 3D 点云。
然后，通过不匹配的遵守三焦约束并通过其端点上的对极几何松弛测试的线段增强 3D 模型。

.. note::

   作者的意思是如果直接同时估计旋转和位移则计算代价太过昂贵（需要6个非线性求解器或13个线性求解器），于是先求相对旋转，然后通过旋转去求位移（即为解耦操作）。

本文采用了一种不依赖于主要消失点的方法。 该算法从三个线段对（匹配两个视图）的子集计算旋转假设，其中两对必须有一个共同的消失点，而第三对必须有一个与第一个正交的消失方向 . 该方法的关键是有效的配置产生围绕真实值紧密聚集的估计，而无效的则给出分布在旋转流形上的估计[10]。